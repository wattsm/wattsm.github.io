<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>    
	Usermaatre &middot; Home    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  
  <style type="text/css">
	
	.left-align {
		text-align:left;
	}
	
	.header-bug {
		font-size:0px;
	}
	
  </style>
  
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  
  <!-- Google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56516871-1', 'auto');
    ga('send', 'pageview');

  </script>
  
</head>


  <body class="theme-base-0b">
  
    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Usermaatre
        </a>
      </h1>
      <p class="lead">Programming, science, history and gaming. Not necessarily in that order.</p>
    </div>

    <nav class="sidebar-nav">
	  <a class="sidebar-nav-item active" href="/">Home</a>
	  <a class="sidebar-nav-item" href="/about">About</a>
	  <a class="sidebar-nav-item" href="/archive">Archive</a>
      <a class="sidebar-nav-item" href="https://twitter.com/m_d_watts" target="_blank">Twitter</a>	  
      <a class="sidebar-nav-item" href="https://github.com/wattsm" target="_blank">GitHub</a>      
    </nav>
	
	<p>&copy; 2015. All rights reserved.</p>
	
	
  </div>
</div>


    <div class="content container">	
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/11/20/constructing-lenses-using-quotations/">
        Constructing lenses using quotations
      </a>
    </h1>

    <span class="post-date">
		20 Nov 2015
&middot;
Programming 

	&middot;
	<a href="/tags/fsharp">F#</a>	

&middot;
<a data-disqus-identifier="Constructing lenses using quotations" href="/programming/2015/11/20/constructing-lenses-using-quotations/#disqus_thread">0 Comments</a>
	</span>

    <p>Earlier this month I wrote a post describing <a href="http://blog.usermaatre.co.uk/programming/2015/10/15/lenses-in-fsharp/">lenses in F#</a>. Lenses are a nice tool for reducing the amount of boilerplate code required when working with
record types, most notably when performing updates. However, the lenses themselves contain a fair amount of boilerplate, with most taking the form:</p>
<div class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">static</span> <span class="k">member</span> <span class="n">Lens_</span> <span class="o">=</span> 
    <span class="o">(</span><span class="k">fun</span> <span class="n">source</span> <span class="o">-&gt;</span> <span class="n">source</span><span class="o">.</span><span class="n">View</span><span class="o">),</span>
    <span class="o">(</span><span class="k">fun</span> <span class="n">view</span> <span class="n">source</span> <span class="o">-&gt;</span> <span class="o">{</span> <span class="n">source</span> <span class="k">with</span> <span class="n">View</span> <span class="o">=</span> <span class="n">view</span><span class="o">;</span> <span class="o">})</span>
</code></pre></div>
<p>I was intrigued, then, when I saw <a href="https://medium.com/@devboy_org/generic-lenses-for-f-record-types-6aea9f4cba40">Dominic Graefen&#39;s post</a> about dynamic lenses using quotations and reflection. His post outlines a way to create a type of lens that 
requires essentially no boilerplate code. Dominic&#39;s approach provides direct update access to record properties without the need for <code>Lens&lt;&#39;TSource, &#39;TView&gt;</code> lens properties:</p>
<div class="highlight"><pre><code class="language-fsharp" data-lang="fsharp"><span class="k">let</span> <span class="nv">original</span> <span class="o">=</span> <span class="o">{</span> <span class="n">View</span> <span class="o">=</span> <span class="s">&quot;Original Value&quot;</span><span class="o">;</span> <span class="o">}</span>
<span class="k">let</span> <span class="nv">updated</span> <span class="o">=</span> <span class="nn">Lens</span><span class="p">.</span><span class="n">With</span> <span class="o">&lt;@</span> <span class="n">original</span><span class="o">.</span><span class="n">View</span> <span class="o">@&gt;</span> <span class="s">&quot;New Value&quot;</span>
</code></pre></div>
<p>In this post I will describe how the same approach of using quotations and reflection can be used to create lens properties.</p>

	
	<a href="/programming/2015/11/20/constructing-lenses-using-quotations/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/11/13/stateful-akka-actors-with-fsharp/">
        Stateful Akka.NET actors with F#
      </a>
    </h1>

    <span class="post-date">
		13 Nov 2015
&middot;
Programming 

	&middot;
	<a href="/tags/fsharp">F#</a>, 	

	
	<a href="/tags/akka.net">Akka.NET</a>	

&middot;
<a data-disqus-identifier="Stateful Akka.NET actors with F#" href="/programming/2015/11/13/stateful-akka-actors-with-fsharp/#disqus_thread">0 Comments</a>
	</span>

    <p><a href="http://getakka.net/">Akka.NET</a> is the .Net implementation of Java&#39;s <a href="http://akka.io/">Akka</a> framework, which allows developers to build &quot;highly concurrent, distributed, and resilient message-driven applications&quot; via
an <a href="https://en.wikipedia.org/wiki/Actor_model">actor model</a>. One of the many nice features of Akka.NET is that it comes with an <a href="http://getakka.net/docs/FSharp%20API">F# API</a>. However, there are some scenarios which the F# API does not specifically cater for, 
and one of those is stafeul actors. </p>

<p>In this post I will describe how to implement a simple stateful Akka.NET actor in a functional style without mutable variables.</p>

	
	<a href="/programming/2015/11/13/stateful-akka-actors-with-fsharp/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/10/15/lenses-in-fsharp/">
        Lenses in F#
      </a>
    </h1>

    <span class="post-date">
		15 Oct 2015
&middot;
Programming 

	&middot;
	<a href="/tags/fsharp">F#</a>	

&middot;
<a data-disqus-identifier="Lenses in F#" href="/programming/2015/10/15/lenses-in-fsharp/#disqus_thread">0 Comments</a>
	</span>

    <p>I recently came across the concept of lenses in functional programming - a useful tool that can significantly reduce the amount of boilerplate code required when working
with <a href="https://msdn.microsoft.com/en-us/library/dd233184.aspx">record types</a>. I first noticed them in <a href="http://suave.io/">suave</a>&#39;s source code and, intrigued, did some further research which lead me to <a href="https://www21.in.tum.de/teaching/fp/SS15/papers/17.pdf">this paper</a> by Albert Steckermeier 
which describes the concept in detail (using Haskell). </p>

<p>As my background is primarily with OO languages I find that I quite often stumble across concepts in functional programming that more experienced practitioners would 
take for granted. There did not seem to a huge amount of information on lenses out there, so I thought I would write a short post about lenses in F#.</p>

	
	<a href="/programming/2015/10/15/lenses-in-fsharp/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/05/20/modeling-historical-dates/">
        Modeling historical dates
      </a>
    </h1>

    <span class="post-date">
		20 May 2015
&middot;
Programming 

	&middot;
	<a href="/tags/fsharp">F#</a>	

&middot;
<a data-disqus-identifier="Modeling historical dates" href="/programming/2015/05/20/modeling-historical-dates/#disqus_thread">0 Comments</a>
	</span>

    <p>As a part of a side project I continually fail to actually start I would need the ability to sort events based on a date. Sounds simple, right? And so it would be if 
all of the dates were CE (or AD if you prefer) or if .Net&#39;s DateTime type supported BCE dates. Unfortunately these dates could be BCE or CE and System.DateTime&#39;s 
minimum value is 1st Jan 1 CE. Further complicating the matter is the fact that these dates come from historical sources which can be extremely vague (e.g. &quot;before January 17 BCE&quot;).</p>

<p>In this post I will look at modeling historical dates using F#. I&#39;ll look at creating a model that captures the vagueness of historical dates and a method for sorting them which is 
further complicated by the surprisingly chequered history of leap years.</p>

	
	<a href="/programming/2015/05/20/modeling-historical-dates/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/04/10/odata-graph-delta/">
        WebAPI OData GraphDelta<T>
      </a>
    </h1>

    <span class="post-date">
		10 Apr 2015
&middot;
Programming 

	&middot;
	<a href="/tags/webapi">WebAPI</a>, 	

	
	<a href="/tags/odata">OData</a>	

&middot;
<a data-disqus-identifier="WebAPI OData GraphDelta<T>" href="/programming/2015/04/10/odata-graph-delta/#disqus_thread">0 Comments</a>
	</span>

    <p>In the course of a recent project I ran into a problem with the standard <code>Delta&lt;T&gt;</code> included in Microsoft WebAPI&#39;s OData functionality: it treats complex properties as atomic 
values meaning that instead of applying the delta to the existing value of the complex property it will create a new, blank value, apply the delta to that
and then set the complex property to the result. </p>

<p><a href="http://stackoverflow.com/questions/27963113/using-deltat-with-complex-objects">I asked about this behaviour on StackOverflow</a> and it turns out that it&#39;s a <a href="https://github.com/OData/WebApi/issues/135">known issue</a>. This post briefly outlines how I implemented an alternative to <code>Delta&lt;T&gt;</code> that handled changes to 
complex types the same way as changes are handled for entities. The post will feature minimal code but source code is <a href="https://github.com/wattsm/odata-graph-delta">available on GitHub</a>.</p>

	
	<a href="/programming/2015/04/10/odata-graph-delta/">Continue reading &raquo;</a>	
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>
    </div>

	
	<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'usermaatre';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
  </body>
</html>
