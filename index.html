<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>    
	Usermaatre &middot; Home    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/syntax.css">
  <link rel="stylesheet" href="/public/css/hyde.css">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700|Abril+Fatface">
  
  <!-- Icons -->
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/public/apple-touch-icon-144-precomposed.png">
                                 <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
  
  
  <!-- Google analytics -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-56516871-1', 'auto');
    ga('send', 'pageview');

  </script>
  
</head>


  <body class="theme-base-0b">
  
    <div class="sidebar">
  <div class="container sidebar-sticky">
    <div class="sidebar-about">
      <h1>
        <a href="/">
          Usermaatre
        </a>
      </h1>
      <p class="lead">Programming, science, history and gaming. Not necessarily in that order.</p>
    </div>

    <nav class="sidebar-nav">
	  <a class="sidebar-nav-item active" href="/">Home</a>
	  <a class="sidebar-nav-item" href="/about">About</a>
	  <a class="sidebar-nav-item" href="/archive">Archive</a>
      <a class="sidebar-nav-item" href="https://twitter.com/m_d_watts" target="_blank">Twitter</a>	  
      <a class="sidebar-nav-item" href="https://github.com/wattsm" target="_blank">GitHub</a>      
    </nav>
	
	<p>&copy; 2015. All rights reserved.</p>
	
	
  </div>
</div>


    <div class="content container">	
      <div class="posts">
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/04/10/odata-graph-delta/">
        WebAPI OData GraphDelta<T>
      </a>
    </h1>

    <span class="post-date">
		10 Apr 2015
&middot;
Programming 

	&middot;
	<a href="/tags/webapi">WebAPI</a>, 	

	
	<a href="/tags/odata">OData</a>	

	</span>

    <p>In the course of a recent project I ran into a problem with the standard <code>Delta&lt;T&gt;</code> included in Microsoft WebAPI&#39;s OData functionality: it treats complex properties as atomic 
values meaning that instead of applying the delta to the existing value of the complex property it will create a new, blank value, apply the delta to that
and then set the complex property to the result. </p>

<p><a href="http://stackoverflow.com/questions/27963113/using-deltat-with-complex-objects">I asked about this behaviour on StackOverflow</a> and it turns out that it&#39;s a <a href="https://github.com/OData/WebApi/issues/135">known issue</a>. This post briefly outlines how I implemented an alternative to <code>Delta&lt;T&gt;</code> that handled changes to 
complex types the same way as changes are handled for entities. The post will feature minimal code but source code is <a href="https://github.com/wattsm/odata-graph-delta">available on GitHub</a>.</p>

	
	<a href="/programming/2015/04/10/odata-graph-delta/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/02/13/using-dbscan-for-fun-and-profit-in-elite-dangerous/">
        Using DBSCAN for fun and (mostly) profit in Elite:Dangerous
      </a>
    </h1>

    <span class="post-date">
		13 Feb 2015
&middot;
Programming 

	&middot;
	<a href="/tags/fsharp">F#</a>, 	

	
	<a href="/tags/elite-dangerous">Elite Dangerous</a>	

	</span>

    <p><a href="https://www.elitedangerous.com/">Elite:Dangerous</a> is the reboot of the classic 1984 space trading, combat and exploration game <a href="http://en.wikipedia.org/wiki/Elite_%28video_game%29">Elite</a> and it has been out for a few months now. After some initial aimless wandering I, like a lot of
people, settled on a career trading rare goods. These goods, as their name suggests, are rare and available in limited quantities and can bring in huge profits if sold sufficiently far away from 
their system of origin. </p>

<p>In order to maximise profits it is desirable to circulate as much as possible between systems that supply rare goods, buying and selling at each stop. One popular strategy
is to follow a circular route, periodically selling and buying. Another, and the one I favour, is to ferry cargo between clusters of systems that supply rare goods - zipping around one cluster buying 
goods and then travelling to another to sell before repeating the process.</p>

<p>The Elite:Dangerous community has done a good job of exploring the game&#39;s trade network and documenting what rare goods are available where, but it can be hard to visualise the systems relative to each
other, even using the in-game galaxy map. So I thought it would be interesting to see if I could take that community generated data and group the systems together into clusters programmatically.</p>

<p>This post details how I used an immutable <a href="http://en.wikipedia.org/wiki/DBSCAN">DBSCAN</a> implementation to identify rare goods clusters in Elite:Dangerous.</p>

	
	<a href="/programming/2015/02/13/using-dbscan-for-fun-and-profit-in-elite-dangerous/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2015/01/19/futures-in-fsharp/">
        Futures in F#
      </a>
    </h1>

    <span class="post-date">
		19 Jan 2015
&middot;
Programming 

	&middot;
	<a href="/tags/fsharp">F#</a>	

	</span>

    <p>My first exposure to the concept of <a href="http://en.wikipedia.org/wiki/Futures_and_promises">futures (or promises)</a> was probably JavaScript&#39;s <a href="https://github.com/kriskowal/q/wiki/API-Reference">Q API</a> and AngularJS&#39; <a href="https://docs.angularjs.org/api/ng/service/$q">$q service</a>, but it was only after reading Twitter&#39;s 
&quot;<a href="https://engineering.twitter.com/research/publication/your-server-as-a-function">Your Server as a Function</a>&quot; paper that their usefulness really sank in. The closest thing that .Net has to the Scala futures illustrated in the paper are <code>Task&lt;T&gt;</code> and 
F#&#39;s <code>Async&lt;&#39;T&gt;</code>. Although these types are useful they do not provide all of the functionality of Scala&#39;s <code>Future[T]</code>, nor are they as elegant.</p>

<p>In this post I will describe an approach to creating something akin to Scala&#39;s <code>Future[T]</code> in F#.</p>

	
	<a href="/programming/2015/01/19/futures-in-fsharp/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2014/12/12/testing-web-api-odata-controllers/">
        Testing Web API OData controllers
      </a>
    </h1>

    <span class="post-date">
		12 Dec 2014
&middot;
Programming 

	&middot;
	<a href="/tags/entity-framework">Entity Framework</a>, 	

	
	<a href="/tags/webapi">WebAPI</a>, 	

	
	<a href="/tags/unit-testing">Unit Testing</a>, 	

	
	<a href="/tags/moq">Moq</a>, 	

	
	<a href="/tags/xunit">xUnit</a>, 	

	
	<a href="/tags/odata">OData</a>	

	</span>

    <p>Microsoft&#39;s <a href="http://msdn.microsoft.com/en-us/data/ef.aspx">Entity Framework</a> is an occasionally handy <a href="https://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a> framework that allows you to query database entities using LINQ and to easily add, update and delete entities via
a variety of helper classes.</p>

<p>Recently I wrote a set of <a href="http://www.asp.net/web-api">WebAPI</a> controllers to expose an Entity Framework model as <a href="http://www.odata.org/">OData</a> endpoints. Exposing an Entity Framework model as OData using WebAPI is <a href="http://www.asp.net/web-api/overview/odata-support-in-aspnet-web-api/odata-v4/create-an-odata-v4-endpoint">incredibly easy</a>.
However, when it came to testing my controllers I found that mocking Entity Framework is tricky, due to a combination of erratic use of interfaces and the apparent complexity of <code>IQueryable&lt;T&gt;</code>. </p>

<p>Luckily my controllers only used a few parts of the EF API, so I decided to write some lightweight wrappers to make testing easier. This had the bonus of also removing dependencies
on EF from my controllers.</p>

	
	<a href="/programming/2014/12/12/testing-web-api-odata-controllers/">Continue reading &raquo;</a>	
  </div>
  
  <div class="post">
    <h1 class="post-title">
      <a href="/programming/2014/11/27/testing-dependency-registrations-with-castle-windsor/">
        Testing dependency registrations with Castle Windsor
      </a>
    </h1>

    <span class="post-date">
		27 Nov 2014
&middot;
Programming 

	&middot;
	<a href="/tags/castle-windsor">Castle Windsor</a>, 	

	
	<a href="/tags/xunit">xUnit</a>, 	

	
	<a href="/tags/unit-testing">Unit Testing</a>	

	</span>

    <p>Until recently one of the most frustrating bugs I have routinely found in my own code is incomplete dependency registrations. </p>

<p>It&#39;s a scenario I&#39;m sure everyone is familiar with - you&#39;ve just written some new components and got the unit tests passing, so now it&#39;s time to fire up the 
application and see your creations in action. Then as soon as the application starts it falls over because you forgot to add your new components to the <a href="http://en.wikipedia.org/wiki/Inversion_of_control">IOC</a> container,
leaving you with unresolvable dependencies.</p>

<p>I would curse my own forgetfulness as I fixed the problem and would often think to myself that it would be really handy if there was a way to test your dependency registrations.
I was pleasantly surprised then to find out that <a href="http://docs.castleproject.org/Default.aspx?Page=MainPage&amp;NS=Windsor&amp;AspxAutoDetectCookieSupport=1">Castle Windsor</a> supports exactly these kinds of tests.</p>

	
	<a href="/programming/2014/11/27/testing-dependency-registrations-with-castle-windsor/">Continue reading &raquo;</a>	
  </div>
  
</div>

<div class="pagination">
  
    <a class="pagination-item older" href="/page2">Older</a>
  
  
    <span class="pagination-item newer">Newer</span>
  
</div>
    </div>

  </body>
</html>
